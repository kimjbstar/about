<!DOCTYPE html><html lang="en"><title>Next.JS + TailwindCSS</title><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><meta name="next-head-count" content="2"/><link rel="icon" href="/favicon.ico"/><link rel="preconnect" href="/" crossorigin="anonymous"/><link rel="preload" href="/blog/_next/static/css/ed67448566454533.css" as="style"/><link rel="stylesheet" href="/blog/_next/static/css/ed67448566454533.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/blog/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/blog/_next/static/chunks/webpack-ebd46948bbd63530.js" defer=""></script><script src="/blog/_next/static/chunks/framework-73b8966a3c579ab0.js" defer=""></script><script src="/blog/_next/static/chunks/main-4c9c2d859eb285fd.js" defer=""></script><script src="/blog/_next/static/chunks/pages/_app-6e97c2e96b7e5bd8.js" defer=""></script><script src="/blog/_next/static/chunks/0f4ba5df-f4fef96fbe8038cd.js" defer=""></script><script src="/blog/_next/static/chunks/664-71f85c7425211588.js" defer=""></script><script src="/blog/_next/static/chunks/556-974ba8e86a8c1b84.js" defer=""></script><script src="/blog/_next/static/chunks/pages/blog/%5Bid%5D-93c70fb44ca1f648.js" defer=""></script><script src="/blog/_next/static/swfh_SCIwC30C98HR8WoR/_buildManifest.js" defer=""></script><script src="/blog/_next/static/swfh_SCIwC30C98HR8WoR/_ssgManifest.js" defer=""></script></head><body><div id="__next"><main class="__className_51b9ad"><nav class="text-s flex justify-center border-b-2 border-gray-100"><div class="flex justify-around max-w-[1200px] w-full"><div class="p-6"><a href="/blog/about">About</a></div><div class="p-6"><a href="/blog/blog">Blog</a></div><div class="p-6"><a href="/blog/other">Other</a></div></div></nav><section class="flex flex-col items-center mt-20"><div class="max-w-7xl flex flex-col"><div class="text-6xl mb-10 font-bold text-gray-800">PHP는 안녕. typescript로의 언어 전환</div><div class="text-4xl mb-10 text-gray-700"></div><div class="self-end">2020-06-01T19:00:00+00:00</div><div class="markdown-body"><h2>PHP</h2>
<p>그동안 제가 회사를 다니며 사용했던 언어는 PHP였습니다. 물론 첫 회사에서 쓸 때보다는 더 고도화된 코드 베이스에서 개발하긴 했지만 어쨋든 PHP는 PHP입니다.</p>
<p>아시다시피 PHP라는 언어가 좋은 언어라고는 할 수 없습니다. 하지만 그러한 이유 때문에 다른 언어로 바꾸기에는 몇년 동안 따라오던 기존 레거시 코드와 컨벤션이 너무 많아 굳이 바꿀 엄두를 내지 못했습니다.</p>
<p>그러던 와중 더 큰 바꿀 이유를 느끼게된 계기는 생태계입니다. 현재 기준으로 라이브러리 생태계가 가장 활발한 곳은 node.js 진영의 npm인데 그에 비해 PHP 진영은 composer가 있긴 하지만 npm에 비해 부실하고 사내 베이스에서는 사용하지 않고 있었습니다. 또한 phpexcel, mongodb등 직접 구현하긴 사이즈가 크고 충분히 있을 법한 라이브러리의 상태가 좋지 않고 업데이트도 잘 안되는 등 불편 사항이 많았습니다.</p>
<p>또한 언어, 프레임워크 자체의 한계도 있었습니다. PHP는 DB 커넥션풀이 지원되지 않고. foreach 관련 버그도 고쳐지지 않았습니다.</p>
<p><a href="https://bugs.php.net/bug.php?id=29992">PHP :: Bug #29992 :: foreach by reference corrupts the array</a></p>
<pre><div class="code-style" style="color:#f8f8f2;background:#272822;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;border-radius:0.3em"><code class="language-php" style="color:#f8f8f2;background:none;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token php language-php delimiter" style="color:#fd971f;font-weight:bold">&lt;?php</span><span class="token php language-php">
</span><span class="token php language-php"></span><span class="token php language-php" style="color:#8292a2">// foreach를 &quot;&amp;&quot; 레퍼런스를 통회 조회 후 어레이 값이 변하는 이슈</span><span class="token php language-php">
</span><span class="token php language-php"></span><span class="token php language-php" style="color:#f8f8f2">$array</span><span class="token php language-php"> </span><span class="token php language-php" style="color:#f8f8f2">=</span><span class="token php language-php"> </span><span class="token php language-php" style="color:#66d9ef">array</span><span class="token php language-php" style="color:#f8f8f2">(</span><span class="token php language-php" style="color:#ae81ff">1</span><span class="token php language-php" style="color:#f8f8f2">,</span><span class="token php language-php" style="color:#ae81ff">2</span><span class="token php language-php" style="color:#f8f8f2">,</span><span class="token php language-php" style="color:#ae81ff">3</span><span class="token php language-php" style="color:#f8f8f2">)</span><span class="token php language-php" style="color:#f8f8f2">;</span><span class="token php language-php">
</span><span class="token php language-php"></span><span class="token php language-php" style="color:#66d9ef">foreach</span><span class="token php language-php" style="color:#f8f8f2">(</span><span class="token php language-php"> </span><span class="token php language-php" style="color:#f8f8f2">$array</span><span class="token php language-php"> </span><span class="token php language-php" style="color:#66d9ef">as</span><span class="token php language-php"> </span><span class="token php language-php" style="color:#f8f8f2">&amp;</span><span class="token php language-php" style="color:#f8f8f2">$item</span><span class="token php language-php"> </span><span class="token php language-php" style="color:#f8f8f2">)</span><span class="token php language-php"> </span><span class="token php language-php" style="color:#f8f8f2">{</span><span class="token php language-php"> </span><span class="token php language-php" style="color:#f8f8f2">}</span><span class="token php language-php">
</span><span class="token php language-php"></span><span class="token php language-php" style="color:#e6db74">print_r</span><span class="token php language-php" style="color:#f8f8f2">(</span><span class="token php language-php"> </span><span class="token php language-php" style="color:#f8f8f2">$array</span><span class="token php language-php"> </span><span class="token php language-php" style="color:#f8f8f2">)</span><span class="token php language-php" style="color:#f8f8f2">;</span><span class="token php language-php">
</span><span class="token php language-php"></span><span class="token php language-php" style="color:#66d9ef">foreach</span><span class="token php language-php" style="color:#f8f8f2">(</span><span class="token php language-php"> </span><span class="token php language-php" style="color:#f8f8f2">$array</span><span class="token php language-php"> </span><span class="token php language-php" style="color:#66d9ef">as</span><span class="token php language-php"> </span><span class="token php language-php" style="color:#f8f8f2">$item</span><span class="token php language-php"> </span><span class="token php language-php" style="color:#f8f8f2">)</span><span class="token php language-php"> </span><span class="token php language-php" style="color:#f8f8f2">{</span><span class="token php language-php"> </span><span class="token php language-php" style="color:#f8f8f2">}</span><span class="token php language-php">
</span><span class="token php language-php"></span><span class="token php language-php" style="color:#e6db74">print_r</span><span class="token php language-php" style="color:#f8f8f2">(</span><span class="token php language-php"> </span><span class="token php language-php" style="color:#f8f8f2">$array</span><span class="token php language-php"> </span><span class="token php language-php" style="color:#f8f8f2">)</span><span class="token php language-php" style="color:#f8f8f2">;</span><span class="token php language-php">
</span><span class="token php language-php"></span><span class="token php language-php" style="color:#8292a2">/*
</span><span class="token php language-php" style="color:#8292a2">Expected result:
</span><span class="token php language-php" style="color:#8292a2">----------------
</span><span class="token php language-php" style="color:#8292a2">Array
</span><span class="token php language-php" style="color:#8292a2">(
</span><span class="token php language-php" style="color:#8292a2">    [0] =&gt; 1
</span><span class="token php language-php" style="color:#8292a2">    [1] =&gt; 2
</span><span class="token php language-php" style="color:#8292a2">    [2] =&gt; 3
</span><span class="token php language-php" style="color:#8292a2">)
</span><span class="token php language-php" style="color:#8292a2">Array
</span><span class="token php language-php" style="color:#8292a2">(
</span><span class="token php language-php" style="color:#8292a2">    [0] =&gt; 1
</span><span class="token php language-php" style="color:#8292a2">    [1] =&gt; 2
</span><span class="token php language-php" style="color:#8292a2">    [2] =&gt; 3
</span><span class="token php language-php" style="color:#8292a2">)
</span><span class="token php language-php" style="color:#8292a2">
</span><span class="token php language-php" style="color:#8292a2">Actual result:
</span><span class="token php language-php" style="color:#8292a2">--------------
</span><span class="token php language-php" style="color:#8292a2">Array
</span><span class="token php language-php" style="color:#8292a2">(
</span><span class="token php language-php" style="color:#8292a2">    [0] =&gt; 1
</span><span class="token php language-php" style="color:#8292a2">    [1] =&gt; 2
</span><span class="token php language-php" style="color:#8292a2">    [2] =&gt; 3
</span><span class="token php language-php" style="color:#8292a2">)
</span><span class="token php language-php" style="color:#8292a2">Array
</span><span class="token php language-php" style="color:#8292a2">(
</span><span class="token php language-php" style="color:#8292a2">    [0] =&gt; 1
</span><span class="token php language-php" style="color:#8292a2">    [1] =&gt; 2
</span><span class="token php language-php" style="color:#8292a2">    [2] =&gt; 2
</span><span class="token php language-php" style="color:#8292a2">)
</span><span class="token php language-php" style="color:#8292a2">*/</span><span class="token php language-php">
</span><span class="token php language-php"></span><span class="token php language-php delimiter" style="color:#fd971f;font-weight:bold">?&gt;</span></code></div></pre>
<p><img src="https://pihxnuyialxsmkzxlpjj.supabase.co/storage/v1/object/public/bucket01/php.png" alt=""/></p>
<p>나름 rails의 스캐폴딩, 단위테스트를 도입하는 등 기존의 컨벤션을 유지하며 코드 베이스의 퀄리티를 고도화 시키려 했으나 한계점에 도달한 것 같다고 느꼈습니다. 위 케이스 등 그냥 넘어갔었던 점들을 다시 곱씹어서 생각해보니 불편했던 점들이 은근히 많았습니다.</p>
<h2>Static Langauge</h2>
<p>더 큰 관점으로 보자면 dynamic langauge에서 static language로 시선이 변하기 시작했는데, 팀 인원이 소수 일때는 dynamic language의 편리함 + 잘 지켜지는 컨벤션으로 큰 생산성을 얻을 수 있었지만, 인원이 증가할 수록 이 컨벤션을 관리하는 것이 점점 힘들어집니다. 기존의 컨벤션을 수정하면 그것을 전파하는 것도 힘이 들고, 새로운 인원이 합류할 시 그 컨벤션을 교육시키는 것도 일입니다. 그래서 이러한 것을 문서화하려는 시도도 해보았지만, 그렇게 되면 문서화하는 인력에 또한 로드가 걸리게 됩니다. 결국 코드에 금이 가기 시작할 수 밖에 없고(깨진 유리창 이론) 코드의 퀄리티를 다시 높이기 위한 고민을 항상 하고는 있었습니다.</p>
<p>그러던 와중 Flutter를 도입하기 위해 dart language 스터디를 하면서 타입 언어의 장점을 알게 되었습니다. 언급했던 컨벤션 등을 따로 관리할 필요 없이 코드 내에 정의해서 녹여낼 수 있기 때문입니다.</p>
<p><img src="https://pihxnuyialxsmkzxlpjj.supabase.co/storage/v1/object/public/bucket01/nodejs.png" alt=""/></p>
<p><img src="https://pihxnuyialxsmkzxlpjj.supabase.co/storage/v1/object/public/bucket01/ts.png" alt=""/></p>
<h2>Node.js 플랫폼 전환</h2>
<p>이러한 점들을 기존의 시스템 코드에 도입할 수 없을까 고민하고 리서치한 결과, 19년 7월부터 약 3개월간 기존의 PHP 베이스 코드를 node.js/typescript 마이그레이션하는 계획을 수립하게 되었습니다. 그러나 이 때 무렵 레드데이즈 프로젝트의 프리오더 시스템 도입으로 업무량이 많아 결국 전면 도입은 하지 못하고 일부 서비스만 분리하여 express 기반으로 구축하였습니다.</p></div></div></section></main></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"blog":{"id":"65f7c702-9b1c-4120-a957-1a411a2b2d36","title":"PHP는 안녕. typescript로의 언어 전환","content":"## PHP\n\n그동안 제가 회사를 다니며 사용했던 언어는 PHP였습니다. 물론 첫 회사에서 쓸 때보다는 더 고도화된 코드 베이스에서 개발하긴 했지만 어쨋든 PHP는 PHP입니다.\n\n아시다시피 PHP라는 언어가 좋은 언어라고는 할 수 없습니다. 하지만 그러한 이유 때문에 다른 언어로 바꾸기에는 몇년 동안 따라오던 기존 레거시 코드와 컨벤션이 너무 많아 굳이 바꿀 엄두를 내지 못했습니다.\n\n그러던 와중 더 큰 바꿀 이유를 느끼게된 계기는 생태계입니다. 현재 기준으로 라이브러리 생태계가 가장 활발한 곳은 node.js 진영의 npm인데 그에 비해 PHP 진영은 composer가 있긴 하지만 npm에 비해 부실하고 사내 베이스에서는 사용하지 않고 있었습니다. 또한 phpexcel, mongodb등 직접 구현하긴 사이즈가 크고 충분히 있을 법한 라이브러리의 상태가 좋지 않고 업데이트도 잘 안되는 등 불편 사항이 많았습니다.\n\n또한 언어, 프레임워크 자체의 한계도 있었습니다. PHP는 DB 커넥션풀이 지원되지 않고. foreach 관련 버그도 고쳐지지 않았습니다.\n\n[PHP :: Bug #29992 :: foreach by reference corrupts the array](https://bugs.php.net/bug.php?id=29992)\n\n```php\n\u003c?php\n// foreach를 \"\u0026\" 레퍼런스를 통회 조회 후 어레이 값이 변하는 이슈\n$array = array(1,2,3);\nforeach( $array as \u0026$item ) { }\nprint_r( $array );\nforeach( $array as $item ) { }\nprint_r( $array );\n/*\nExpected result:\n----------------\nArray\n(\n    [0] =\u003e 1\n    [1] =\u003e 2\n    [2] =\u003e 3\n)\nArray\n(\n    [0] =\u003e 1\n    [1] =\u003e 2\n    [2] =\u003e 3\n)\n\nActual result:\n--------------\nArray\n(\n    [0] =\u003e 1\n    [1] =\u003e 2\n    [2] =\u003e 3\n)\nArray\n(\n    [0] =\u003e 1\n    [1] =\u003e 2\n    [2] =\u003e 2\n)\n*/\n?\u003e\n```\n\n![](https://pihxnuyialxsmkzxlpjj.supabase.co/storage/v1/object/public/bucket01/php.png)\n\n나름 rails의 스캐폴딩, 단위테스트를 도입하는 등 기존의 컨벤션을 유지하며 코드 베이스의 퀄리티를 고도화 시키려 했으나 한계점에 도달한 것 같다고 느꼈습니다. 위 케이스 등 그냥 넘어갔었던 점들을 다시 곱씹어서 생각해보니 불편했던 점들이 은근히 많았습니다.\n\n## Static Langauge\n\n더 큰 관점으로 보자면 dynamic langauge에서 static language로 시선이 변하기 시작했는데, 팀 인원이 소수 일때는 dynamic language의 편리함 + 잘 지켜지는 컨벤션으로 큰 생산성을 얻을 수 있었지만, 인원이 증가할 수록 이 컨벤션을 관리하는 것이 점점 힘들어집니다. 기존의 컨벤션을 수정하면 그것을 전파하는 것도 힘이 들고, 새로운 인원이 합류할 시 그 컨벤션을 교육시키는 것도 일입니다. 그래서 이러한 것을 문서화하려는 시도도 해보았지만, 그렇게 되면 문서화하는 인력에 또한 로드가 걸리게 됩니다. 결국 코드에 금이 가기 시작할 수 밖에 없고(깨진 유리창 이론) 코드의 퀄리티를 다시 높이기 위한 고민을 항상 하고는 있었습니다.\n\n그러던 와중 Flutter를 도입하기 위해 dart language 스터디를 하면서 타입 언어의 장점을 알게 되었습니다. 언급했던 컨벤션 등을 따로 관리할 필요 없이 코드 내에 정의해서 녹여낼 수 있기 때문입니다. \n\n![](https://pihxnuyialxsmkzxlpjj.supabase.co/storage/v1/object/public/bucket01/nodejs.png)\n\n![](https://pihxnuyialxsmkzxlpjj.supabase.co/storage/v1/object/public/bucket01/ts.png)\n\n## Node.js 플랫폼 전환\n\n이러한 점들을 기존의 시스템 코드에 도입할 수 없을까 고민하고 리서치한 결과, 19년 7월부터 약 3개월간 기존의 PHP 베이스 코드를 node.js/typescript 마이그레이션하는 계획을 수립하게 되었습니다. 그러나 이 때 무렵 레드데이즈 프로젝트의 프리오더 시스템 도입으로 업무량이 많아 결국 전면 도입은 하지 못하고 일부 서비스만 분리하여 express 기반으로 구축하였습니다.","created_at":"2020-06-01T19:00:00+00:00","subtitle":null,"is_show":true}},"__N_SSG":true},"page":"/blog/[id]","query":{"id":"65f7c702-9b1c-4120-a957-1a411a2b2d36"},"buildId":"swfh_SCIwC30C98HR8WoR","assetPrefix":"/blog","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>